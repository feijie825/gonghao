


ARM Macro Assembler    Page 1 


    1 00000000         ;*******************************************************
                       ***********************
    2 00000000         ;
    3 00000000         ; bl_startup_rvmdk.S - Startup code for RV-MDK.
    4 00000000         ;
    5 00000000         ; Copyright (c) 2007-2008 Luminary Micro, Inc.  All righ
                       ts reserved.
    6 00000000         ; 
    7 00000000         ; Software License Agreement
    8 00000000         ; 
    9 00000000         ; Luminary Micro, Inc. (LMI) is supplying this software 
                       for use solely and
   10 00000000         ; exclusively on LMI's microcontroller products.
   11 00000000         ; 
   12 00000000         ; The software is owned by LMI and/or its suppliers, and
                        is protected under
   13 00000000         ; applicable copyright laws.  All rights are reserved.  
                       You may not combine
   14 00000000         ; this software with "viral" open-source software in ord
                       er to form a larger
   15 00000000         ; program.  Any use in violation of the foregoing restri
                       ctions may subject
   16 00000000         ; the user to criminal sanctions under applicable laws, 
                       as well as to civil
   17 00000000         ; liability for the breach of the terms and conditions o
                       f this license.
   18 00000000         ; 
   19 00000000         ; THIS SOFTWARE IS PROVIDED "AS IS".  NO WARRANTIES, WHE
                       THER EXPRESS, IMPLIED
   20 00000000         ; OR STATUTORY, INCLUDING, BUT NOT LIMITED TO, IMPLIED W
                       ARRANTIES OF
   21 00000000         ; MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE A
                       PPLY TO THIS SOFTWARE.
   22 00000000         ; LMI SHALL NOT, IN ANY CIRCUMSTANCES, BE LIABLE FOR SPE
                       CIAL, INCIDENTAL, OR
   23 00000000         ; CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.
   24 00000000         ; 
   25 00000000         ; This is part of revision 3416 of the Stellaris Periphe
                       ral Driver Library.
   26 00000000         ;
   27 00000000         ;*******************************************************
                       ***********************
   28 00000000         
   29 00000000                 include          bl_config.inc
    1 00000000         #line   1                "bl_config.c"
    1 00000000         
    2 00000000         
    3 00000000         
    4 00000000         
    5 00000000         
    6 00000000         
    7 00000000         
    8 00000000         
    9 00000000         
   10 00000000         
   11 00000000         
   12 00000000         
   13 00000000         
   14 00000000         



ARM Macro Assembler    Page 2 


   15 00000000         
   16 00000000         
   17 00000000         
   18 00000000         
   19 00000000         
   20 00000000         
   21 00000000         
   22 00000000         
   23 00000000         
   24 00000000         
   25 00000000         
   26 00000000         
   27 00000000         
   28 00000000         
   29 00000000         #line   1                "bl_config.h"
    1 00000000         
    2 00000000         
    3 00000000         
    4 00000000         
    5 00000000         
    6 00000000         
    7 00000000         
    8 00000000         
    9 00000000         
   10 00000000         
   11 00000000         
   12 00000000         
   13 00000000         
   14 00000000         
   15 00000000         
   16 00000000         
   17 00000000         
   18 00000000         
   19 00000000         
   20 00000000         
   21 00000000         
   22 00000000         
   23 00000000         
   24 00000000         
   25 00000000         
   26 00000000         
   27 00000000         
   28 00000000         
   29 00000000         
   30 00000000         
   31 00000000         
   32 00000000         
   33 00000000         
   34 00000000         
   35 00000000         
   36 00000000         
   37 00000000         
   38 00000000         
   39 00000000         
   40 00000000         
   41 00000000         
   42 00000000         
   43 00000000         
   44 00000000         



ARM Macro Assembler    Page 3 


   45 00000000         
   46 00000000         
   47 00000000         
   48 00000000         
   49 00000000         
   50 00000000         
   51 00000000         
   52 00000000         
   53 00000000         
   54 00000000         
   55 00000000         
   56 00000000         
   57 00000000         
   58 00000000         
   59 00000000         
   60 00000000         
   61 00000000         
   62 00000000         
   63 00000000         
   64 00000000         
   65 00000000         
   66 00000000         
   67 00000000         
   68 00000000         
   69 00000000         
   70 00000000         
   71 00000000         
   72 00000000         
   73 00000000         
   74 00000000         
   75 00000000         
   76 00000000         
   77 00000000         
   78 00000000         
   79 00000000         
   80 00000000         
   81 00000000         
   82 00000000         
   83 00000000         
   84 00000000         
   85 00000000         
   86 00000000         
   87 00000000         
   88 00000000         
   89 00000000         
   90 00000000         
   91 00000000         
   92 00000000         
   93 00000000         
   94 00000000         
   95 00000000         
   96 00000000         
   97 00000000         
   98 00000000         
   99 00000000         
  100 00000000         
  101 00000000         
  102 00000000         
  103 00000000         



ARM Macro Assembler    Page 4 


  104 00000000         
  105 00000000         
  106 00000000         
  107 00000000         
  108 00000000         
  109 00000000         
  110 00000000         
  111 00000000         
  112 00000000         
  113 00000000         
  114 00000000         
  115 00000000         
  116 00000000         
  117 00000000         
  118 00000000         
  119 00000000         
  120 00000000         
  121 00000000         
  122 00000000         
  123 00000000         
  124 00000000         
  125 00000000         
  126 00000000         
  127 00000000         
  128 00000000         
  129 00000000         
  130 00000000         
  131 00000000         
  132 00000000         
  133 00000000         
  134 00000000         
  135 00000000         
  136 00000000         
  137 00000000         
  138 00000000         
  139 00000000         
  140 00000000         
  141 00000000         
  142 00000000         
  143 00000000         
  144 00000000         
  145 00000000         
  146 00000000         
  147 00000000         
  148 00000000         
  149 00000000         
  150 00000000         
  151 00000000         
  152 00000000         
  153 00000000         
  154 00000000         
  155 00000000         
  156 00000000         
  157 00000000         
  158 00000000         
  159 00000000         
  160 00000000         
  161 00000000         
  162 00000000         



ARM Macro Assembler    Page 5 


  163 00000000         
  164 00000000         
  165 00000000         
  166 00000000         
  167 00000000         
  168 00000000         
  169 00000000         
  170 00000000         
  171 00000000         
  172 00000000         
  173 00000000         
  174 00000000         
  175 00000000         
  176 00000000         
  177 00000000         
  178 00000000         
  179 00000000         
  180 00000000         
  181 00000000         
  182 00000000         
  183 00000000         
  184 00000000         
  185 00000000         
  186 00000000         
  187 00000000         
  188 00000000         
  189 00000000         
  190 00000000         
  191 00000000         
  192 00000000         
  193 00000000         
  194 00000000         
  195 00000000         
  196 00000000         
  197 00000000         
  198 00000000         
  199 00000000         
  200 00000000         
  201 00000000         
  202 00000000         
  203 00000000         
  204 00000000         
  205 00000000         
  206 00000000         
  207 00000000         
  208 00000000         
  209 00000000         
  210 00000000         
  211 00000000         
  212 00000000         
  213 00000000         
  214 00000000         
  215 00000000         
  216 00000000         
  217 00000000         
  218 00000000         
  219 00000000         
  220 00000000         
  221 00000000         



ARM Macro Assembler    Page 6 


  222 00000000         
  223 00000000         
  224 00000000         
  225 00000000         
  226 00000000         
  227 00000000         
  228 00000000         
  229 00000000         
  230 00000000         
  231 00000000         
  232 00000000         
  233 00000000         
  234 00000000         
  235 00000000         
  236 00000000         
  237 00000000         
  238 00000000         
  239 00000000         
  240 00000000         
  241 00000000         
  242 00000000         
  243 00000000         
  244 00000000         
  245 00000000         
  246 00000000         
  247 00000000         
  248 00000000         
  249 00000000         
  250 00000000         
  251 00000000         
  252 00000000         
  253 00000000         
  254 00000000         
  255 00000000         
  256 00000000         
  257 00000000         
  258 00000000         
  259 00000000         
  260 00000000         
  261 00000000         
  262 00000000         
  263 00000000         
  264 00000000         
  265 00000000         
  266 00000000         
  267 00000000         
  268 00000000         
  269 00000000         
  270 00000000         
  271 00000000         
  272 00000000         
  273 00000000         
  274 00000000         
  275 00000000         
  276 00000000         
  277 00000000         
  278 00000000         
  279 00000000         
  280 00000000         



ARM Macro Assembler    Page 7 


  281 00000000         
  282 00000000         
  283 00000000         
  284 00000000         
  285 00000000         
  286 00000000         
  287 00000000         
  288 00000000         
  289 00000000         
  290 00000000         
  291 00000000         
  292 00000000         
  293 00000000         
  294 00000000         
  295 00000000         
  296 00000000         
  297 00000000         
  298 00000000         
  299 00000000         
  300 00000000         
  301 00000000         
  302 00000000         
  303 00000000         
  304 00000000         
  305 00000000         
  306 00000000         
  307 00000000         
  308 00000000         
  309 00000000         
  310 00000000         
  311 00000000         
  312 00000000         
  313 00000000         
  314 00000000         
  315 00000000         
  316 00000000         
  317 00000000         
  318 00000000         
  319 00000000         
  320 00000000         
  321 00000000         
  322 00000000         
  323 00000000         
  324 00000000         
  325 00000000         
  326 00000000         
  327 00000000         
  328 00000000         
  329 00000000         
  330 00000000         
  331 00000000         
  332 00000000         
  333 00000000         
  334 00000000         
  335 00000000         
  336 00000000         
  337 00000000         
  338 00000000         
  339 00000000         



ARM Macro Assembler    Page 8 


  340 00000000         
  341 00000000         
  342 00000000         
  343 00000000         
  344 00000000         
  345 00000000         
  346 00000000         
  347 00000000         
  348 00000000         
  349 00000000         
  350 00000000         
  351 00000000         
  352 00000000         
  353 00000000         
  354 00000000         
  355 00000000         
  356 00000000         
  357 00000000         
  358 00000000         
  359 00000000         
  360 00000000         
  361 00000000         
  362 00000000         
  363 00000000         
  364 00000000         
  365 00000000         
  366 00000000         
  367 00000000         
  368 00000000         
  369 00000000         
  370 00000000         
  371 00000000         
  372 00000000         
  373 00000000         
  374 00000000         
  375 00000000         
  376 00000000         
  377 00000000         
  378 00000000         
  379 00000000         
  380 00000000         
  381 00000000         
  382 00000000         
  383 00000000         
  384 00000000         
  385 00000000         
  386 00000000         
  387 00000000         
  388 00000000         
  389 00000000         
  390 00000000         
  391 00000000         
  392 00000000         
  393 00000000         
  394 00000000         
  395 00000000         
  396 00000000         
  397 00000000         
  398 00000000         #line   30               "bl_config.c"



ARM Macro Assembler    Page 9 


   30 00000000         
   31 00000000         
   32 00000000         
   33 00000000         
   34 00000000         
   35 00000000         
   36 00000000         
   37 00000000         
   38 00000000         
   39 00000000         
   40 00000000         
   41 00000000         
   42 00000000         
   43 00000000         
   44 00000000         
   45 00000000         
   46 00000000         
   47 00000000         
   48 00000000         
   49 00000000         
   50 00000000 00000030 
                       _STACK_SIZE
                               equ              48
   51 00000000         
   52 00000000         
   53 00000000         
   54 00000000         
   55 00000000         
   56 00000000         
   57 00000000 00000C00 
                       _APP_START_ADDRESS
                               equ              0x00000C00
   58 00000000         
   59 00000000         
   60 00000000         
   61 00000000         
   62 00000000 00000001 
                       _BOOT_UART0
                               equ              1
   63 00000000         
   64 00000000         
   65 00000000         
   66 00000000         
   67 00000000         
   68 00000000         
   69 00000000         
   70 00000000 00000001 
                       _UART_ENABLE_UPDATE
                               equ              1
   71 00000000         
   72 00000000         
   73 00000000         
   74 00000000         
   75 00000000         
   76 00000000         
   77 00000000         
   78 00000000         
   79 00000000         
   80 00000000         



ARM Macro Assembler    Page 10 


   81 00000000         
   82 00000000         
   83 00000000         
   84 00000000         
   85 00000000         
   86 00000000         
   87 00000000         
   88 00000000         
   89 00000000         
   90 00000000         
   91 00000000         
   92 00000000         
   93 00000000         
   94 00000000         
   95 00000000         
   96 00000000         
   97 00000000                 end
   30 00000000         
   31 00000000         ;*******************************************************
                       ***********************
   32 00000000         ;
   33 00000000         ; Put the assembler into the correct configuration.
   34 00000000         ;
   35 00000000         ;*******************************************************
                       ***********************
   36 00000000                 thumb
   37 00000000                 require8
   38 00000000                 preserve8
   39 00000000         
   40 00000000 400FE034 
                       SYSCTL_LDOPCTL
                               equ              0x400FE034
   41 00000000 0000001B 
                       SYSCTL_LDOPCTL_2_75V
                               equ              0x0000001B
   42 00000000 400FE060 
                       SYSCTL_RCC
                               equ              0x400FE060
   43 00000000 00000000 
                       SYSCTL_RCC_OSCSRC_MAIN
                               equ              0x00000000
   44 00000000 00000380 
                       SYSCTL_RCC_XTAL_8MHZ
                               EQU              0x00000380  ; Using a 8MHz crys
                                                            tal
   45 00000000 00000002 
                       SYSCTL_RCC_IOSCDIS
                               EQU              0x00000002  ; Internal oscillat
                                                            or disable
   46 00000000         
   47 00000000         ;*******************************************************
                       ***********************
   48 00000000         ;
   49 00000000         ; The stack gets placed into the zero-init section.
   50 00000000         ;
   51 00000000         ;*******************************************************
                       ***********************
   52 00000000                 area             ||.bss||, noinit, align=2
   53 00000000         



ARM Macro Assembler    Page 11 


   54 00000000         ;*******************************************************
                       ***********************
   55 00000000         ;
   56 00000000         ; Allocate storage for the stack.
   57 00000000         ;
   58 00000000         ;*******************************************************
                       ***********************
   59 00000000         g_pulStack
   60 00000000                 space            _STACK_SIZE * 4
   61 000000C0         ;*******************************************************
                       ***********************
   62 000000C0         ;
   63 000000C0         ; This portion of the file goes into the text section.
   64 000000C0         ;
   65 000000C0         ;*******************************************************
                       ***********************
   66 000000C0                 area             RESET, code, readonly, align=3
   67 00000000         
   68 00000000         ;*******************************************************
                       ***********************
   69 00000000         ;
   70 00000000         ; The minimal vector table for a Cortex-M3 processor.
   71 00000000         ;
   72 00000000         ;*******************************************************
                       ***********************
   73 00000000                 export           __Vectors
   74 00000000         __Vectors
   75 00000000 000000C0        dcd              g_pulStack + (_STACK_SIZE * 4) 
                                                            ; Offset 00: Initia
                                                            l stack pointer
   76 00000004 00000000        dcd              Reset_Handler ; Offset 04: Rese
                                                            t handler
   77 00000008 20000000        dcd              NmiSR + 0x20000000 ; Offset 08:
                                                             NMI handler
   78 0000000C 20000000        dcd              FaultISR + 0x20000000 ; Offset 
                                                            0C: Hard fault hand
                                                            ler
   79 00000010 20000000        dcd              IntDefaultHandler + 0x20000000 
                                                            ; Offset 10: MPU fa
                                                            ult handler
   80 00000014 20000000        dcd              IntDefaultHandler + 0x20000000 
                                                            ; Offset 14: Bus fa
                                                            ult handler
   81 00000018 20000000        dcd              IntDefaultHandler + 0x20000000 
                                                            ; Offset 18: Usage 
                                                            fault handler
   82 0000001C 00000000        dcd              0           ; Offset 1C: Reserv
                                                            ed
   83 00000020 00000000        dcd              0           ; Offset 20: Reserv
                                                            ed
   84 00000024 00000000        dcd              0           ; Offset 24: Reserv
                                                            ed
   85 00000028 00000000        dcd              0           ; Offset 28: Reserv
                                                            ed
   86 0000002C 00000000        dcd              UpdateHandler ; Offset 2C: SVCa
                                                            ll handler
   87 00000030 20000000        dcd              IntDefaultHandler + 0x20000000 
                                                            ; Offset 30: Debug 
                                                            monitor handler



ARM Macro Assembler    Page 12 


   88 00000034 00000000        dcd              0           ; Offset 34: Reserv
                                                            ed
   89 00000038 20000000        dcd              IntDefaultHandler + 0x20000000 
                                                            ; Offset 38: PendSV
                                                             handler
   90 0000003C                 import           SysTickIntHandler
   91 0000003C 00000000        dcd              SysTickIntHandler ; Offset 3C: 
                                                            SysTick handler
   92 00000040                 if               :def:_BOOT_UART0 :land: :def:_U
ART_ENABLE_UPDATE :land: :def:_UART_AUTOBAUD
   96 00000040 20000000        dcd              IntDefaultHandler + 0x20000000 
                                                            ; PORTA
   97 00000044                 endif
   98 00000044 20000000        dcd              IntDefaultHandler + 0x20000000 
                                                            ; PORTB
   99 00000048 20000000        dcd              IntDefaultHandler + 0x20000000 
                                                            ; PORTC
  100 0000004C                 if               :def:_BOOT_UART1 :land: :def:_U
ART_ENABLE_UPDATE :land: :def:_UART_AUTOBAUD
  104 0000004C 20000000        dcd              IntDefaultHandler + 0x20000000 
                                                            ; PORTD
  105 00000050                 endif
  106 00000050         
  107 00000050         ;*******************************************************
                       ***********************
  108 00000050         ;
  109 00000050         ; The reset handler, which gets called when the processo
                       r starts.
  110 00000050         ;
  111 00000050         ;*******************************************************
                       ***********************
  112 00000050                 export           Reset_Handler
  113 00000050         Reset_Handler
  114 00000050 F04F 0108       mov              r1,#8
  115 00000054 F649 4040 
                       Del0    mov              r0,#40000   ;开机延时20ms
  116 00000058 3801    Del1    subs             r0, #1
  117 0000005A D1FD            bne              Del1
  118 0000005C 3901            subs             r1,#1
  119 0000005E D1F9            bne              Del0
  120 00000060 F000 F811       bl               Reset_Target ;复位
  121 00000064 F000 F824       bl               ProcessorInit ;初始化
  122 00000068         ; See if a an update should be performed.
  123 00000068         ; 检测强制更新管脚  
  124 00000068                 import           CheckForceUpdate
  125 00000068 F7FF FFFE       bl               CheckForceUpdate
  126 0000006C B118            cbz              r0, CallApplication
  127 0000006E         ; Configure the microcontroller.
  128 0000006E         ; 是否允许通过以太网升级程序
  129 0000006E                 if               :def:_ENET_ENABLE_UPDATE
  133 0000006E         ; 芯片配置程序    
  134 0000006E                 import           ConfigureDevice
  135 0000006E F7FF FFFE       bl               ConfigureDevice
  136 00000072                 endif
  137 00000072         ; Branch to the update handler.
  138 00000072         ;
  139 00000072                 if               :def:_ENET_ENABLE_UPDATE
  143 00000072                 import           Updater
  144 00000072 F7FF BFFE       b                Updater



ARM Macro Assembler    Page 13 


  145 00000076                 endif
  146 00000076         ; Call the application via the reset handler in its vect
                       or table.  Load the
  147 00000076         ; address of the application vector table.
  148 00000076         ; 调用用户应用程序
  149 00000076         CallApplication
  150 00000076 F44F 6040       ldr              r0, =_APP_START_ADDRESS
  151 0000007A         ; Set the vector table address to the beginning of the a
                       pplication.
  152 0000007A         ; 设置中断向量偏移地址-> 指向用户程序起始地址
  153 0000007A 4930            ldr              r1, =0xe000ed08
  154 0000007C 6008            str              r0, [r1]
  155 0000007E         ; Load the stack pointer from the application's vector t
                       able.
  156 0000007E         ; 从用户应用程序中取出堆栈表设置堆栈指针
  157 0000007E 6801            ldr              r1, [r0]
  158 00000080 468D            mov              sp, r1
  159 00000082         ; Load the initial PC from the application's vector tabl
                       e and branch to
  160 00000082         ; the application's entry point.
  161 00000082         ; 跳转到用户程序
  162 00000082 6840            ldr              r0, [r0, #4]
  163 00000084 4700            bx               r0
  164 00000086         
  165 00000086         ;内核复位 zlz2008.11.12添加
  166 00000086         Reset_Target
  167 00000086                 if               :def: _BOOST_LDO_VOLTAGE
  168 00000086 482E            ldr              r0,=SYSCTL_LDOPCTL ;
  169 00000088 6801            ldr              r1,[r0]
  170 0000008A F041 011B       orr              r1,#SYSCTL_LDOPCTL_2_75V 
                                                            ;内核电压设置r2
  171 0000008E 6001            str              r1,[r0]
  172 00000090                 endif
  173 00000090                 if               :def: _CRYSTAL_FREQ
  174 00000090 482C            ldr              r0,=SYSCTL_RCC
  175 00000092 6801            ldr              r1,[r0]
  176 00000094 F240 32F3       movw             r2,#0x003f3
  177 00000098 F442 2280       orr              r2,#0x40000
  178 0000009C EA6F 0202       mvn              r2,r2
  179 000000A0 EA01 0102       and              r1,r2
  180 000000A4 F441 7160       orr              r1,#SYSCTL_RCC_XTAL_8MHZ
  181 000000A8 F041 0102       orr              r1,#SYSCTL_RCC_IOSCDIS
  182 000000AC 6001            str              r1,[r0]
  183 000000AE                 endif
  184 000000AE 4770            bx               lr
  185 000000B0         ;*******************************************************
                       ***********************
  186 000000B0         ;
  187 000000B0         ; Initialize the processor by copying the boot loader fr
                       om flash to SRAM, zero
  188 000000B0         ; filling the .bss section, and moving the vector table 
                       to the beginning of
  189 000000B0         ; SRAM.  The return address is modified to point to the 
                       SRAM copy of the boot
  190 000000B0         ; loader instead of the flash copy, resulting in a branc
                       h to the copy now in
  191 000000B0         ; SRAM.
  192 000000B0         ;
  193 000000B0         ;*******************************************************



ARM Macro Assembler    Page 14 


                       ***********************
  194 000000B0         ProcessorInit
  195 000000B0         ; 将程序代码从00~程序结束拷贝到RAM区 起始地址0x20000000
  196 000000B0         ; 清除引导使能标志
  197 000000B0                 import           BOOT_EN
  198 000000B0 F3EF 8010       mrs              r0, PRIMASK
  199 000000B4 B672            cpsid            i
  200 000000B6 2200            movs             r2, #0
  201 000000B8 2300            movs             r3, #0
  202 000000BA F04F 5000       ldr              r0, =0x20000000
  203 000000BE F850 1B04       ldr              r1, [r0], #4
  204 000000C2 2945            cmp              r1,#'E'
  205 000000C4 D105            bne              BOOT1
  206 000000C6 F850 1B04       ldr              r1, [r0], #4
  207 000000CA 2945            cmp              r1,#'E'
  208 000000CC D101            bne              BOOT1
  209 000000CE 2245            movs             r2, #0x45
  210 000000D0 6803            ldr              r3, [r0]
  211 000000D2         BOOT1
  212 000000D2 481D            ldr              r0, =BOOT_EN
  213 000000D4 F840 2B04       str              r2,[r0],#4  ;BOOT_EN[0]
  214 000000D8 F840 2B04       str              r2,[r0],#4  ;BOOT_EN[1]        
                                                            
  215 000000DC 6003            str              r3,[r0]     ;BOOT_EN[2]        
                                                            
  216 000000DE 2000            movs             r0, #0x00000000
  217 000000E0 F04F 5100       ldr              r1, =0x20000000
  218 000000E4                 import           ||Image$$ZI$$Base||
  219 000000E4 4A19            ldr              r2, =||Image$$ZI$$Base||
  220 000000E6         copy_loop
  221 000000E6 F850 3B04       ldr              r3, [r0], #4
  222 000000EA F841 3B04       str              r3, [r1], #4
  223 000000EE 4291            cmp              r1, r2
  224 000000F0 DBF9            blt              copy_loop
  225 000000F2         ; Zero fill the .bss section.
  226 000000F2         ; 清除剩余RAM区
  227 000000F2 2000            movs             r0, #0x00000000
  228 000000F4                 import           ||Image$$ZI$$Limit||
  229 000000F4 4A16            ldr              r2, =||Image$$ZI$$Limit||
  230 000000F6         zero_loop
  231 000000F6 F841 0B04       str              r0, [r1], #4
  232 000000FA 4291            cmp              r1, r2
  233 000000FC DBFB            blt              zero_loop
  234 000000FE         ; Set the vector table pointer to the beginning of SRAM.
                       
  235 000000FE         ; 设置中断向量起始地址为0x20000000即RAM区
  236 000000FE 480F            ldr              r0, =0xe000ed08 ;nvic->vtable
  237 00000100 F04F 5100       ldr              r1, =0x20000000
  238 00000104 6001            str              r1, [r0]
  239 00000106         ; Set the return address to the code just copied into SR
                       AM.
  240 00000106         ; 程序进入RAM运行
  241 00000106 F04E 5E00       orr              lr, lr, #0x20000000
  242 0000010A F3EF 8010       mrs              r0, PRIMASK
  243 0000010E B662            cpsie            i
  244 00000110 4770            bx               lr
  245 00000112         
  246 00000112         
  247 00000112         ;*******************************************************



ARM Macro Assembler    Page 15 


                       ***********************
  248 00000112         ;
  249 00000112         ; Wrapper function for the CPSID instruction.  Returns t
                       he state of PRIMASK
  250 00000112         ; on entry.
  251 00000112         ; 关闭中断
  252 00000112         ;*******************************************************
                       ***********************
  253 00000112                 export           CPUcpsid
  254 00000112         CPUcpsid
  255 00000112 F3EF 8010       mrs              r0, PRIMASK
  256 00000116 B672            cpsid            i
  257 00000118 4770            bx               lr
  258 0000011A         
  259 0000011A         ;*******************************************************
                       ***********************
  260 0000011A         ;
  261 0000011A         ; Wrapper function for the CPSIE instruction.  Returns t
                       he state of PRIMASK
  262 0000011A         ; on entry.
  263 0000011A         ; 使能中断
  264 0000011A         ;*******************************************************
                       ***********************
  265 0000011A                 export           CPUcpsie
  266 0000011A         CPUcpsie
  267 0000011A F3EF 8010       mrs              r0, PRIMASK
  268 0000011E B662            cpsie            i
  269 00000120 4770            bx               lr
  270 00000122         
  271 00000122         
  272 00000122         ;*******************************************************
                       ***********************
  273 00000122         ;
  274 00000122         ; The update handler, which gets called when the applica
                       tion would like to
  275 00000122         ; start an update.
  276 00000122         ;
  277 00000122         
  278 00000122         ;*******************************************************
                       ***********************
  279 00000122         UpdateHandler
  280 00000122         ; Initialize the processor.
  281 00000122         ;
  282 00000122 F7FF FFC5       bl               ProcessorInit
  283 00000126         ; Load the stack pointer from the vector table.
  284 00000126         ;
  285 00000126 2000            movs             r0, #0x00000000
  286 00000128 6800            ldr              r0, [r0]
  287 0000012A 4685            mov              sp, r0
  288 0000012C         ; Branch to the update handler.
  289 0000012C         ;
  290 0000012C                 if               :def:_ENET_ENABLE_UPDATE
  293 0000012C F7FF BFFE       b                Updater
  294 00000130                 endif
  295 00000130         
  296 00000130         ;*******************************************************
                       ***********************
  297 00000130         ;
  298 00000130         ; The NMI handler.



ARM Macro Assembler    Page 16 


  299 00000130         ;
  300 00000130         ;*******************************************************
                       ***********************
  301 00000130         NmiSR
  302 00000130         ; Loop forever since there is nothing that we can do abo
                       ut a NMI.
  303 00000130         ;
  304 00000130 E7FE            b                .
  305 00000132         
  306 00000132         ;*******************************************************
                       ***********************
  307 00000132         ;
  308 00000132         ; The hard fault handler.
  309 00000132         ;
  310 00000132         ;*******************************************************
                       ***********************
  311 00000132         FaultISR
  312 00000132         ; Loop forever since there is nothing that we can do abo
                       ut a hard fault.
  313 00000132         ;
  314 00000132 E7FE            b                .
  315 00000134         
  316 00000134         ;*******************************************************
                       ***********************
  317 00000134         ;
  318 00000134         ; The default interrupt handler.
  319 00000134         ;
  320 00000134         ;*******************************************************
                       ***********************
  321 00000134         IntDefaultHandler
  322 00000134         ; Loop forever since there is nothing that we can do abo
                       ut an unexpected
  323 00000134         ; interrupt.
  324 00000134         ;
  325 00000134 E7FE            b                .
  326 00000136         
  327 00000136         ;*******************************************************
                       ***********************
  328 00000136         ;
  329 00000136         ; Provides a small delay.  The loop below takes 3 cycles
                       /loop.
  330 00000136         ;
  331 00000136         ;*******************************************************
                       ***********************
  332 00000136                 export           Delay
  333 00000136         Delay
  334 00000136 3801            subs             r0, #1
  335 00000138 D1FE            bne              Delay
  336 0000013A 4770            bx               lr
  337 0000013C         
  338 0000013C         ;*******************************************************
                       ***********************
  339 0000013C         ;
  340 0000013C         ; This is the end of the file.
  341 0000013C         ;
  342 0000013C         ;*******************************************************
                       ***********************
  343 0000013C                 align            4
  344 0000013C                 end



ARM Macro Assembler    Page 17 


              E000ED08 
              400FE034 
              400FE060 
              00000000 
              00000000 
              00000000 
Command Line: --debug --xref --cpu=Cortex-M3 --apcs=interwork --depend=.\bl_sta
rtup_rvmdk.d -o.\bl_startup_rvmdk.o -IC:\Keil\ARM\RV31\INC -IC:\Keil\ARM\CMSIS\
Include -IC:\Keil\ARM\Inc\Luminary --predefine="__MICROLIB SETA 1" --predefine=
"_BOOST_LDO_VOLTAGE SETA 1" --predefine="_CRYSTAL_FREQ SETA 1" --list=.\bl_star
tup_rvmdk.lst bl_startup_rvmdk.S



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

g_pulStack 00000000

Symbol: g_pulStack
   Definitions
      At line 59 in file bl_startup_rvmdk.S
   Uses
      At line 75 in file bl_startup_rvmdk.S
Comment: g_pulStack used once
|.bss| 00000000

Symbol: |.bss|
   Definitions
      At line 52 in file bl_startup_rvmdk.S
   Uses
      None
Comment: |.bss| unused
2 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

BOOT1 000000D2

Symbol: BOOT1
   Definitions
      At line 211 in file bl_startup_rvmdk.S
   Uses
      At line 205 in file bl_startup_rvmdk.S
      At line 208 in file bl_startup_rvmdk.S

CPUcpsid 00000112

Symbol: CPUcpsid
   Definitions
      At line 254 in file bl_startup_rvmdk.S
   Uses
      At line 253 in file bl_startup_rvmdk.S
Comment: CPUcpsid used once
CPUcpsie 0000011A

Symbol: CPUcpsie
   Definitions
      At line 266 in file bl_startup_rvmdk.S
   Uses
      At line 265 in file bl_startup_rvmdk.S
Comment: CPUcpsie used once
CallApplication 00000076

Symbol: CallApplication
   Definitions
      At line 149 in file bl_startup_rvmdk.S
   Uses
      At line 126 in file bl_startup_rvmdk.S
Comment: CallApplication used once
Del0 00000054

Symbol: Del0
   Definitions
      At line 115 in file bl_startup_rvmdk.S
   Uses
      At line 119 in file bl_startup_rvmdk.S
Comment: Del0 used once
Del1 00000058

Symbol: Del1
   Definitions
      At line 116 in file bl_startup_rvmdk.S
   Uses
      At line 117 in file bl_startup_rvmdk.S
Comment: Del1 used once
Delay 00000136

Symbol: Delay
   Definitions
      At line 333 in file bl_startup_rvmdk.S
   Uses
      At line 332 in file bl_startup_rvmdk.S
      At line 335 in file bl_startup_rvmdk.S

FaultISR 00000132



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols


Symbol: FaultISR
   Definitions
      At line 311 in file bl_startup_rvmdk.S
   Uses
      At line 78 in file bl_startup_rvmdk.S
Comment: FaultISR used once
IntDefaultHandler 00000134

Symbol: IntDefaultHandler
   Definitions
      At line 321 in file bl_startup_rvmdk.S
   Uses
      At line 79 in file bl_startup_rvmdk.S
      At line 80 in file bl_startup_rvmdk.S
      At line 81 in file bl_startup_rvmdk.S
      At line 87 in file bl_startup_rvmdk.S
      At line 89 in file bl_startup_rvmdk.S
      At line 96 in file bl_startup_rvmdk.S
      At line 98 in file bl_startup_rvmdk.S
      At line 99 in file bl_startup_rvmdk.S
      At line 104 in file bl_startup_rvmdk.S

NmiSR 00000130

Symbol: NmiSR
   Definitions
      At line 301 in file bl_startup_rvmdk.S
   Uses
      At line 77 in file bl_startup_rvmdk.S
Comment: NmiSR used once
ProcessorInit 000000B0

Symbol: ProcessorInit
   Definitions
      At line 194 in file bl_startup_rvmdk.S
   Uses
      At line 121 in file bl_startup_rvmdk.S
      At line 282 in file bl_startup_rvmdk.S

RESET 00000000

Symbol: RESET
   Definitions
      At line 66 in file bl_startup_rvmdk.S
   Uses
      None
Comment: RESET unused
Reset_Handler 00000050

Symbol: Reset_Handler
   Definitions
      At line 113 in file bl_startup_rvmdk.S
   Uses
      At line 76 in file bl_startup_rvmdk.S
      At line 112 in file bl_startup_rvmdk.S

Reset_Target 00000086




ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Relocatable symbols

Symbol: Reset_Target
   Definitions
      At line 166 in file bl_startup_rvmdk.S
   Uses
      At line 120 in file bl_startup_rvmdk.S
Comment: Reset_Target used once
UpdateHandler 00000122

Symbol: UpdateHandler
   Definitions
      At line 279 in file bl_startup_rvmdk.S
   Uses
      At line 86 in file bl_startup_rvmdk.S
Comment: UpdateHandler used once
__Vectors 00000000

Symbol: __Vectors
   Definitions
      At line 74 in file bl_startup_rvmdk.S
   Uses
      At line 73 in file bl_startup_rvmdk.S
Comment: __Vectors used once
copy_loop 000000E6

Symbol: copy_loop
   Definitions
      At line 220 in file bl_startup_rvmdk.S
   Uses
      At line 224 in file bl_startup_rvmdk.S
Comment: copy_loop used once
zero_loop 000000F6

Symbol: zero_loop
   Definitions
      At line 230 in file bl_startup_rvmdk.S
   Uses
      At line 233 in file bl_startup_rvmdk.S
Comment: zero_loop used once
18 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

SYSCTL_LDOPCTL 400FE034

Symbol: SYSCTL_LDOPCTL
   Definitions
      At line 40 in file bl_startup_rvmdk.S
   Uses
      At line 168 in file bl_startup_rvmdk.S
Comment: SYSCTL_LDOPCTL used once
SYSCTL_LDOPCTL_2_75V 0000001B

Symbol: SYSCTL_LDOPCTL_2_75V
   Definitions
      At line 41 in file bl_startup_rvmdk.S
   Uses
      At line 170 in file bl_startup_rvmdk.S
Comment: SYSCTL_LDOPCTL_2_75V used once
SYSCTL_RCC 400FE060

Symbol: SYSCTL_RCC
   Definitions
      At line 42 in file bl_startup_rvmdk.S
   Uses
      At line 174 in file bl_startup_rvmdk.S
Comment: SYSCTL_RCC used once
SYSCTL_RCC_IOSCDIS 00000002

Symbol: SYSCTL_RCC_IOSCDIS
   Definitions
      At line 45 in file bl_startup_rvmdk.S
   Uses
      At line 181 in file bl_startup_rvmdk.S
Comment: SYSCTL_RCC_IOSCDIS used once
SYSCTL_RCC_OSCSRC_MAIN 00000000

Symbol: SYSCTL_RCC_OSCSRC_MAIN
   Definitions
      At line 43 in file bl_startup_rvmdk.S
   Uses
      None
Comment: SYSCTL_RCC_OSCSRC_MAIN unused
SYSCTL_RCC_XTAL_8MHZ 00000380

Symbol: SYSCTL_RCC_XTAL_8MHZ
   Definitions
      At line 44 in file bl_startup_rvmdk.S
   Uses
      At line 180 in file bl_startup_rvmdk.S
Comment: SYSCTL_RCC_XTAL_8MHZ used once
_APP_START_ADDRESS 00000C00

Symbol: _APP_START_ADDRESS
   Definitions
      At line 57 in file bl_config.c
   Uses
      At line 150 in file bl_startup_rvmdk.S
Comment: _APP_START_ADDRESS used once
_BOOT_UART0 00000001

Symbol: _BOOT_UART0



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Absolute symbols

   Definitions
      At line 62 in file bl_config.c
   Uses
      None
Comment: _BOOT_UART0 unused
_STACK_SIZE 00000030

Symbol: _STACK_SIZE
   Definitions
      At line 50 in file bl_config.c
   Uses
      At line 60 in file bl_startup_rvmdk.S
      At line 75 in file bl_startup_rvmdk.S

_UART_ENABLE_UPDATE 00000001

Symbol: _UART_ENABLE_UPDATE
   Definitions
      At line 70 in file bl_config.c
   Uses
      None
Comment: _UART_ENABLE_UPDATE unused
10 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

BOOT_EN 00000000

Symbol: BOOT_EN
   Definitions
      At line 197 in file bl_startup_rvmdk.S
   Uses
      At line 212 in file bl_startup_rvmdk.S
Comment: BOOT_EN used once
CheckForceUpdate 00000000

Symbol: CheckForceUpdate
   Definitions
      At line 124 in file bl_startup_rvmdk.S
   Uses
      At line 125 in file bl_startup_rvmdk.S
Comment: CheckForceUpdate used once
ConfigureDevice 00000000

Symbol: ConfigureDevice
   Definitions
      At line 134 in file bl_startup_rvmdk.S
   Uses
      At line 135 in file bl_startup_rvmdk.S
Comment: ConfigureDevice used once
SysTickIntHandler 00000000

Symbol: SysTickIntHandler
   Definitions
      At line 90 in file bl_startup_rvmdk.S
   Uses
      At line 91 in file bl_startup_rvmdk.S
Comment: SysTickIntHandler used once
Updater 00000000

Symbol: Updater
   Definitions
      At line 143 in file bl_startup_rvmdk.S
   Uses
      At line 144 in file bl_startup_rvmdk.S
      At line 293 in file bl_startup_rvmdk.S

|Image$$ZI$$Base| 00000000

Symbol: |Image$$ZI$$Base|
   Definitions
      At line 218 in file bl_startup_rvmdk.S
   Uses
      At line 219 in file bl_startup_rvmdk.S
Comment: |Image$$ZI$$Base| used once
|Image$$ZI$$Limit| 00000000

Symbol: |Image$$ZI$$Limit|
   Definitions
      At line 228 in file bl_startup_rvmdk.S
   Uses
      At line 229 in file bl_startup_rvmdk.S
Comment: |Image$$ZI$$Limit| used once
7 symbols
384 symbols in table
